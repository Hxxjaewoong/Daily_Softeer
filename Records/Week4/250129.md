# ğŸ“… 2025.01.29 ë¦¬ë·° & íšŒê³ 

---

# ğŸ“ ë¦¬ë·°

## W4M1 ì§„í–‰

### Dockerfile

```docker
FROM bitnami/spark:latest

ENV SPARK_MASTER_URL=spark://spark-master:7077
ENV SPARK_WORKER_CORES=2
ENV SPARK_WORKER_MEMORY=2G

EXPOSE 8080 7077 8081 4040

CMD ["/opt/bitnami/scripts/spark/entrypoint.sh"]
```

Bitnamiì˜ Spark ì´ë¯¸ì§€?

- Bitmamiê°€ ê´€ë¦¬í•˜ê³  ë°°í¬í•˜ëŠ” Apache Sparkì˜ Docker ì´ë¯¸ì§€
- í•´ë‹¹ ì´ë¯¸ì§€ë¥¼ ì‚¬ìš©ì‹œ ì„¤ì¹˜ ë° ì„¤ì • ê³¼ì •ì„ ë‹¨ìˆœí™” ê°€ëŠ¥

`SPARK_MASTER_URL`: Spark ë§ˆìŠ¤í„° ë…¸ë“œì˜ URLì„ ì§€ì •

`SPARK_WORKER_CORES`: ì›Œì»¤ ë…¸ë“œê°€ ì‚¬ìš©í•  CPU ì½”ì–´ ìˆ˜ë¥¼ ì§€ì •

`SPARK_WORKER_MEMORY`: ì›Œì»¤ ë…¸ë“œê°€ ì‚¬ìš©í•  ë©”ëª¨ë¦¬ ì–‘ì„ ì§€ì •

CMD ëª…ë ¹ì–´ë¥¼ í†µí•˜ì—¬ ì»¨í…Œì´ë„ˆê°€ ì‹œì‘ë  ë•Œ Bitnami Spark ì´ë¯¸ì§€ì— í¬í•¨ëœ ì—”íŠ¸ë¦¬í¬ì¸íŠ¸ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰

### Pi.py

```python
from pyspark.sql import SparkSession
import random

# import os

# output_dir = "/opt/bitnami/spark/output/"
# if not os.path.exists(output_dir):
#     os.makedirs(output_dir)

def inside(_):
    x, y = random.random(), random.random()
    return 1 if x*x + y*y < 1 else 0

if __name__ == "__main__":
    spark = SparkSession.builder.appName("Pi Estimation").getOrCreate()

    num_samples = 1000000
    count = spark.sparkContext.parallelize(range(num_samples)).map(inside).reduce(lambda a, b: a + b)

    pi = (4.0 * count) / num_samples
    print(f"Estimated value of Ï€: {pi}")

    output_path = "/opt/bitnami/spark/output/pi_result.csv"
    df = spark.createDataFrame([(pi,)], ["estimated_pi"])
    df.write.csv(output_path, mode="overwrite", header=True)

    print(f"Pi value saved to {output_path}")
    spark.stop()

```

- pyspark.sql.SparkSession: Spark ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹œì‘í•˜ê³  ê´€ë¦¬í•˜ëŠ” ë° ì‚¬ìš©ë¨
- SparkSession.builder.appName("Pi Estimation").getOrCreate(): SparkSessionì„ ìƒì„±í•˜ì—¬ Spark ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹œì‘ â†’ ì• í”Œë¦¬ì¼€ì´ì…˜ ì´ë¦„ì€ "Pi Estimationâ€
- spark.sparkContext.parallelize(range(num_samples)): 0ë¶€í„°Â num_samplesê¹Œì§€ì˜ ìˆ«ìë¥¼ RDDë¡œ ë³‘ë ¬í™”
- `.map(inside)`: ê° ìˆ«ìì— ëŒ€í•´Â insideÂ í•¨ìˆ˜ë¥¼ ì ìš©í•˜ì—¬ ë‹¨ìœ„ ì› ì•ˆì— ìˆëŠ” ì ì˜ ìˆ˜ë¥¼ ê³„ì‚°
- `.reduce(lambda a, b: a + b)`: ëª¨ë“  ê°’ì„ ë”í•˜ì—¬ ë‹¨ìœ„ ì› ì•ˆì— ìˆëŠ” ì´ ì ì˜ ìˆ˜ë¥¼ ê³„ì‚°

<aside>
ğŸ’¡

í˜„ì¬ ë¬¸ì œì 

ë¡œê·¸ë¡œëŠ” PI ê°’ì´ ì¶œë ¥ë˜ëŠ”ë° íŒŒì¼ì´ ì €ì¥ë˜ì§€ ì•ŠëŠ” ë¬¸ì œ..

</aside>

### compose.yml

```yaml
version: "3"
services:
  spark-master:
    image: bitnami/spark:latest
    container_name: spark-master
    hostname: spark-master
    ports:
      - "8080:8080" # Spark Web UI
      - "7077:7077" # Spark Master URL
    environment:
      - SPARK_MODE=master
    volumes:
      - ./output:/opt/bitnami/spark/output # <== íŒŒì¼ì„ ë¡œì»¬ ì‹œìŠ¤í…œê³¼ ê³µìœ 

  spark-worker-1:
    image: bitnami/spark:latest
    container_name: spark-worker-1
    depends_on:
      - spark-master
    environment:
      - SPARK_MODE=worker
      - SPARK_MASTER_URL=spark://spark-master:7077

  spark-worker-2:
    image: bitnami/spark:latest
    container_name: spark-worker-2
    depends_on:
      - spark-master
    environment:
      - SPARK_MODE=worker
      - SPARK_MASTER_URL=spark://spark-master:7077
```

## Mini Team Project

ìš°ë¦¬ì˜ í”„ë¡œì íŠ¸ì˜ ì•„ì´ë””ì–´ ì„¸ë¶€ ì‚¬í•­ì´ â€œActionable í•œ ë°ì´í„°â€ì¸ì§€ ìƒê°í•´ë³´ê¸°

- ì–´ë–¤ ìƒí™©ì—ì„œ ì–´ë–¤ ë¬¸ì œë¥¼ ê²ªì„ê¹Œ?
  - ì—¬ëŸ¬ ê²½ê¸°ê°€ ë™ì‹œì— ì—´ë ¤ ë‹¤ì–‘í•œ íŒ€ê³¼ ì„ ìˆ˜ì˜ ë°ì´í„°ë¥¼ ë¹ ë¥´ê²Œ í™•ë³´í•´ì•¼ í•˜ëŠ” ë¬¸ì œ
  - ê°œë³„ ì‚¬ì´íŠ¸ë¥¼ ì¼ì¼ì´ ëŒì•„ë‹¤ë‹ˆë©° ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•˜ëŠ” ë° ë§ì€ ì‹œê°„ì´ ì†Œìš”ë˜ëŠ” ë¬¸ì œ
  - ê¸‰ì‘ìŠ¤ëŸ½ê²Œ íˆ¬ì…ëœ ì„ ìˆ˜(í‰ì†Œì— ì£¼ì „ì´ ì•„ë‹ˆì—ˆë˜ ì„ ìˆ˜)ì— ëŒ€í•œ ì¤€ë¹„ëœ ì •ë³´ê°€ ë¶€ì¡±í•´ ë‹¹í™©í•˜ëŠ” ë¬¸ì œ
  - (ì¤‘ê³„ ì¤‘ ì‹¤ì‹œê°„ìœ¼ë¡œ ë¹ ë¥´ê²Œ í•´ë‹¹ ì„ ìˆ˜ì˜ ê°ê´€ì  ê¸°ë¡ì„ í™•ì¸í•´ì•¼ í•˜ëŠ” ë¬¸ì œ)
  - ì„ ìˆ˜ì— ëŒ€í•œ ì „ë¬¸ê°€ì˜ 'ì²´ê° í¼í¬ë¨¼ìŠ¤' ë“± ì •ì„±ì  ìš”ì†Œê°€ í©ì–´ì ¸ ìˆê³  ì¼ê´€ì ìœ¼ë¡œ ì·¨í•©í•˜ê¸° ì–´ë µë‹¤ëŠ” ë¬¸ì œ
  - (ì—¬ëŸ¬ ëª…ì˜ ì „ë¬¸ê°€, ì‚¬ì´íŠ¸ë“¤ì´ íŠ¹ì • ì„ ìˆ˜ì— ëŒ€í•´ ë‹¤ë¥´ê²Œ í‰ê°€í•˜ë¯€ë¡œ)
  - (í•´ë‹¹ ì„ ìˆ˜ì˜ ìë£Œê°€ ì—¬ëŸ¬ ì¶œë ¥ë¬¼ì— ë¶„ì‚°ë˜ì–´ ìˆê±°ë‚˜ ë‹¨ìˆœíˆ ìˆ«ì ê°’ìœ¼ë¡œë§Œ ì í˜€ìˆë‹¤ë©´ ë¹ ë¥´ê²Œ ë©˜íŠ¸ë¥¼ ì¹˜ê¸° ì–´ë ¤ìš¸ ê²ƒì´ë‹¤.)
  - ì„ ìˆ˜ ëª…ë‹¨ì€ ê²½ê¸° 1ì‹œê°„ ì „ì— ë°œí‘œë¨ -> ê·¸ ì „ì— ì˜ˆìƒì¹˜ ëª»í–ˆë˜ ì„ ìˆ˜ê°€ ë“±ì¥ì‹œ ëŒ€ì²˜ê°€ ë¹¨ë¼ì•¼í•˜ì§€ë§Œ ë§¤ìš° í˜ë“¦.
  - ì˜ˆìƒì¹˜ ëª»í–ˆë˜ ì„ ìˆ˜ê°€ ê¸‰ì‘ìŠ¤ëŸ° í™œì•½ìœ¼ë¡œ "ì´ ì„ ìˆ˜ê°€ ì™œ ì´ë ‡ê²Œ ì˜í•´?" í•˜ëŠ” ê¶ê¸ˆì¦ì´ ì»¤ì¡Œì§€ë§Œ, ë‹¨ìˆœí•œ ì •ë³´ë¡œëŠ” ì„¤ëª…ì´ ì–´ë ¤ìš´ ë¬¸ì œ
- ì´ë¥¼ í†µí•´ ì–´ë–¤ ì˜ì‚¬ ê²°ì •ì„ í•  ìˆ˜ ìˆëŠ”ê°€?
  1. ê²½ê¸°ë³„ ì£¼ìš” ì„ ë°œÂ·êµì²´ ëª…ë‹¨ ì˜ˆì¸¡ì´ ê°€ëŠ¥í•˜ë©°, ì˜ˆìƒì¹˜ ëª»í•œ ì„ ìˆ˜ ë“±ì¥ (ìƒí™©) ë“±ì´ ë°œìƒí•´ë„ ë¯¸ë¦¬ ì¤€ë¹„í•˜ì§€ ì•Šì€ ë°ì´í„°ì— ëŒ€í•œ ë¹ ë¥¸ ëŒ€ì²˜ê°€ ê°€ëŠ¥
  2. íš¨ìœ¨ì ì¸ ë¶„ì„ í¬ì¸íŠ¸ ì„ ì •ì´ ê°€ëŠ¥í•˜ë‹¤. ê³µê²© í¬ì¸íŠ¸ê°€ ê°€ì¥ ë›°ì–´ë‚œ ì„ ìˆ˜, ìˆ˜ë¹„ ì§€í‘œê°€ ìš°ìˆ˜í•œ ì„ ìˆ˜ ë“±ì„ ê°ê´€ì  í†µê³„ë¡œ ì„ ë³„í•´ ë°©ì†¡ ì¤‘ ê°•ì¡°í•´ì•¼ í•  ì„ ìˆ˜ë¥¼ ê²°ì •
  3. ë°©ì†¡ ê¸°íšÂ·êµ¬ì„± ì‹œ íš¨ìœ¨ì ì¸ ëŒ€ë³¸ êµ¬ì„±ì´ ê°€ëŠ¥ -> ë§ì€ ë°ì´í„°ë¥¼ ë¹ ë¥´ê²Œ ì·¨í•©í•´ ë°©ì†¡ ëŒ€ë³¸ì„ ì‘ì„±í•  ë•Œ ì–´ë–¤ ì •ë³´ë¥¼ ìš°ì„ í• ì§€ ë¹ ë¥¸ ì •ë³´ ê²€ìƒ‰ì„ í† ëŒ€ë¡œ ë¹ ë¥¸ íŒë‹¨ì´ ê°€ëŠ¥
  4. ì •ì„±ì  ë°ì´í„°ë¥¼ í™•ë³´í•´ "ì´ ì„ ìˆ˜ê°€ ì´ë ‡ê²Œ í™œì•½í•  ìˆ˜ ìˆì—ˆë˜ ì´ìœ "ë¥¼ ë‹¤ëŸ‰ì˜ ë°ì´í„°ë¥¼ í†µí•´ í•´ì„ ë° ì „ë‹¬ì´ ê°€ëŠ¥
  5. ì‚¬ì´íŠ¸ (êµ­ê°€ ë° ê¸°ê´€ ë³„ë¡œ)ë§ˆë‹¤ í¸ì°¨ê°€ ìˆë˜ ì •ë³´(ì£¼ê´€ì )ë¥¼ ìµœëŒ€í•œ ê°ê´€ì ì¸ ì •ë³´ë¡œ ì „í™˜í•˜ì—¬ ì •ë³´ë¥¼ ì „ë‹¬í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ê°€ë”ì”© í¸í–¥ëœ ì •ë³´ë§Œì„ ì œê³µí•œë‹¤ëŠ” ê¸°ì¡´ í•´ì„¤ì˜ ë¬¸ì œì  ì™„í™” ê°€ëŠ¥

Code Demo ì‘ì„±

---

# ğŸ” íšŒê³  (KPT)

## âœ… Keep

- ì§œíˆ¬ë¦¬ ì‹œê°„ ì˜ í™œìš©í•˜ê¸° !
  - ì„¤ë‚  ë‹¹ì¼ì´ë¼ì„œ ì—¬ëŸ¬ ê³³ì„ ì™”ë‹¤ê°”ë‹¤ í–ˆì§€ë§Œ, ì´ë™ ì¤‘ì´ë‚˜ í•  ì¼ì´ ì—†ì„ ë•Œ í‹ˆí‹ˆíˆ ë…¸íŠ¸ë¶ì„ ë´¤ê¸°ì— ì¡°ê¸ˆì´ë¼ë„ ì‘ì—…ì„ í•  ìˆ˜ ìˆì—ˆë˜ ê²ƒ ê°™ë‹¤.

## âš ï¸ Problem

-

## ğŸ’¡ Try

- íŒ€ í”„ë¡œì íŠ¸ ë¿ë§Œ ì•„ë‹ˆë¼ ë‚´ í•  ì¼ì— ëŒ€í•œ ì¼ì •ë„ ë” ì„¸ë¶„í™” í•˜ê¸° !

---
